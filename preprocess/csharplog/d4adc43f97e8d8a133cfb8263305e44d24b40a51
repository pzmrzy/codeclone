commit d4adc43f97e8d8a133cfb8263305e44d24b40a51
Author:     sharwell <sharwell@pixelminegames.com>
AuthorDate: Wed Feb 2 15:52:13 2011 -0800
Commit:     sharwell <sharwell@pixelminegames.com>
CommitDate: Wed Feb 2 15:52:13 2011 -0800

(C# 3) Rename the Inspect() extension method to Visualize()
Use the Visualize extension method in TestVisualizer instead of duplicating the code

[git-p4: depot-paths = "//depot/code/antlrcs/main/": change = 7606]

diff --git a/Antlr4.StringTemplate.Visualizer/Extensions/TemplateExtensions.cs b/Antlr4.StringTemplate.Visualizer/Extensions/TemplateExtensions.cs
index 5ff5bfa..52d0e2f 100644
--- a/Antlr4.StringTemplate.Visualizer/Extensions/TemplateExtensions.cs
+++ b/Antlr4.StringTemplate.Visualizer/Extensions/TemplateExtensions.cs
@@ -39,22 +39,22 @@ namespace Antlr4.StringTemplate.Visualizer.Extensions

public static class TemplateExtensions
{
-        public static void Inspect(this DebugST template)
+        public static void Visualize(this DebugST template)
{
-            Inspect(template, CultureInfo.CurrentCulture);
+            Visualize(template, CultureInfo.CurrentCulture);
}

-        public static void Inspect(this DebugST template, int lineWidth)
+        public static void Visualize(this DebugST template, int lineWidth)
{
-            Inspect(template, template.impl.nativeGroup.ErrorManager, CultureInfo.CurrentCulture, lineWidth);
+            Visualize(template, template.impl.nativeGroup.ErrorManager, CultureInfo.CurrentCulture, lineWidth);
}

-        public static void Inspect(this DebugST template, CultureInfo culture)
+        public static void Visualize(this DebugST template, CultureInfo culture)
{
-            Inspect(template, template.impl.nativeGroup.ErrorManager, culture, AutoIndentWriter.NoWrap);
+            Visualize(template, template.impl.nativeGroup.ErrorManager, culture, AutoIndentWriter.NoWrap);
}

-        public static void Inspect(this DebugST template, ErrorManager errorManager, CultureInfo culture, int lineWidth)
+        public static void Visualize(this DebugST template, ErrorManager errorManager, CultureInfo culture, int lineWidth)
{
ErrorBuffer errors = new ErrorBuffer();
template.impl.nativeGroup.Listener = errors;
diff --git a/Antlr4.Test.StringTemplate/TestVisualizer.cs b/Antlr4.Test.StringTemplate/TestVisualizer.cs
index 23a6bc4..b133984 100644
--- a/Antlr4.Test.StringTemplate/TestVisualizer.cs
+++ b/Antlr4.Test.StringTemplate/TestVisualizer.cs
@@ -37,6 +37,7 @@ namespace Antlr4.Test.StringTemplate
using Antlr4.StringTemplate.Debug;
using Antlr4.StringTemplate.Misc;
using Antlr4.StringTemplate.Visualizer;
+    using Antlr4.StringTemplate.Visualizer.Extensions;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using CultureInfo = System.Globalization.CultureInfo;
using Path = System.IO.Path;
@@ -82,31 +83,7 @@ namespace Antlr4.Test.StringTemplate
st.Add("stats", s2);
st.Add("stats", s3);

-            Inspect(st);
-            //st.Render();
-        }
-
-        private void Inspect(DebugST template)
-        {
-            Inspect(template, CultureInfo.CurrentCulture);
-        }
-
-        private void Inspect(DebugST template, CultureInfo culture)
-        {
-            Inspect(template, template.impl.nativeGroup.ErrorManager, culture, AutoIndentWriter.NoWrap);
-        }
-
-        private void Inspect(DebugST template, ErrorManager errorManager, CultureInfo culture, int lineWidth)
-        {
-            ErrorBuffer errors = new ErrorBuffer();
-            template.impl.nativeGroup.Listener = errors;
-            StringWriter @out = new StringWriter();
-            ITemplateWriter wr = new AutoIndentWriter(@out);
-            wr.LineWidth = lineWidth;
-            Interpreter interp = new Interpreter(template.groupThatCreatedThisInstance, culture);
-            interp.Execute(wr, template); // Render and track events
-            TemplateVisualizer visualizer = new TemplateVisualizer(errorManager, template, @out.ToString(), interp, interp.GetExecutionTrace(), errors.Errors);
-            visualizer.Show();
+            st.Visualize();
}
}
}

