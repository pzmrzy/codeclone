commit 342817891bf9f494a317f8ae5feb8bcfc6bcd09a
Author:     Sam Harwell <sam@tunnelvisionlabs.com>
AuthorDate: Fri Aug 9 23:47:57 2013 -0500
Commit:     Sam Harwell <sam@tunnelvisionlabs.com>
CommitDate: Fri Aug 9 23:52:28 2013 -0500

Initial NuGet support

diff --git a/Antlr3.StringTemplate/Antlr3.StringTemplate.csproj b/Antlr3.StringTemplate/Antlr3.StringTemplate.csproj
index 6eb88f2..f067d7e 100644
--- a/Antlr3.StringTemplate/Antlr3.StringTemplate.csproj
+++ b/Antlr3.StringTemplate/Antlr3.StringTemplate.csproj
@@ -24,6 +24,7 @@
<DefineConstants>TRACE;DEBUG;COMPILE_EXPRESSIONS; CACHE_FUNCTORS</DefineConstants>
<ErrorReport>prompt</ErrorReport>
<WarningLevel>4</WarningLevel>
+    <DocumentationFile>bin\Debug\Antlr3.StringTemplate.xml</DocumentationFile>
</PropertyGroup>
<PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
<DebugType>pdbonly</DebugType>
@@ -32,6 +33,7 @@
<DefineConstants>TRACE;COMPILE_EXPRESSIONS; CACHE_FUNCTORS</DefineConstants>
<ErrorReport>prompt</ErrorReport>
<WarningLevel>4</WarningLevel>
+    <DocumentationFile>bin\Release\Antlr3.StringTemplate.xml</DocumentationFile>
</PropertyGroup>
<ItemGroup>
<Reference Include="System" />
diff --git a/Antlr3/Antlr3.csproj b/Antlr3/Antlr3.csproj
index 28fca77..bf106f8 100644
--- a/Antlr3/Antlr3.csproj
+++ b/Antlr3/Antlr3.csproj
@@ -24,6 +24,7 @@
<DefineConstants>TRACE;DEBUG</DefineConstants>
<ErrorReport>prompt</ErrorReport>
<WarningLevel>4</WarningLevel>
+    <DocumentationFile>..\bin\Debug\Antlr3.xml</DocumentationFile>
</PropertyGroup>
<PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
<DebugType>pdbonly</DebugType>
@@ -32,6 +33,7 @@
<DefineConstants>TRACE</DefineConstants>
<ErrorReport>prompt</ErrorReport>
<WarningLevel>4</WarningLevel>
+    <DocumentationFile>..\bin\Release\Antlr3.xml</DocumentationFile>
</PropertyGroup>
<ItemGroup>
<Reference Include="System" />
diff --git a/Antlr4.StringTemplate.Visualizer/Antlr4.StringTemplate.Visualizer.csproj b/Antlr4.StringTemplate.Visualizer/Antlr4.StringTemplate.Visualizer.csproj
index 4267197..783eeb6 100644
--- a/Antlr4.StringTemplate.Visualizer/Antlr4.StringTemplate.Visualizer.csproj
+++ b/Antlr4.StringTemplate.Visualizer/Antlr4.StringTemplate.Visualizer.csproj
@@ -24,6 +24,7 @@
<DefineConstants>DEBUG;TRACE</DefineConstants>
<ErrorReport>prompt</ErrorReport>
<WarningLevel>4</WarningLevel>
+    <DocumentationFile>bin\Debug\Antlr4.StringTemplate.Visualizer.xml</DocumentationFile>
</PropertyGroup>
<PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
<DebugType>pdbonly</DebugType>
@@ -32,6 +33,7 @@
<DefineConstants>TRACE</DefineConstants>
<ErrorReport>prompt</ErrorReport>
<WarningLevel>4</WarningLevel>
+    <DocumentationFile>bin\Release\Antlr4.StringTemplate.Visualizer.xml</DocumentationFile>
</PropertyGroup>
<PropertyGroup>
<SignAssembly>true</SignAssembly>
diff --git a/Antlr4.StringTemplate/Antlr4.StringTemplate.csproj b/Antlr4.StringTemplate/Antlr4.StringTemplate.csproj
index 8fe7166..e8d69de 100644
--- a/Antlr4.StringTemplate/Antlr4.StringTemplate.csproj
+++ b/Antlr4.StringTemplate/Antlr4.StringTemplate.csproj
@@ -22,6 +22,7 @@
<DefineConstants>DEBUG;TRACE</DefineConstants>
<ErrorReport>prompt</ErrorReport>
<WarningLevel>4</WarningLevel>
+    <DocumentationFile>bin\Debug\Antlr4.StringTemplate.xml</DocumentationFile>
</PropertyGroup>
<PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
<DebugType>pdbonly</DebugType>
@@ -30,6 +31,7 @@
<DefineConstants>TRACE</DefineConstants>
<ErrorReport>prompt</ErrorReport>
<WarningLevel>4</WarningLevel>
+    <DocumentationFile>bin\Release\Antlr4.StringTemplate.xml</DocumentationFile>
</PropertyGroup>
<ItemGroup>
<Reference Include="System" />
diff --git a/AntlrBuildTask/Antlr3.props b/AntlrBuildTask/Antlr3.props
new file mode 100644
index 0000000..b18aaa8
--- /dev/null
+++ b/AntlrBuildTask/Antlr3.props
@@ -0,0 +1,9 @@
+﻿<?xml version="1.0" encoding="utf-8" ?>
+<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
+  <PropertyGroup>
+    <!-- Folder containing AntlrBuildTask.dll -->
+    <AntlrBuildTaskPath>.</AntlrBuildTaskPath>
+    <!-- Path to the ANTLR tool itself -->
+    <AntlrToolPath>..\tools\Antlr3.exe</AntlrToolPath>
+  </PropertyGroup>
+</Project>
diff --git a/AntlrBuildTask/AntlrBuildTask.csproj b/AntlrBuildTask/AntlrBuildTask.csproj
index abf67ec..2e171e8 100644
--- a/AntlrBuildTask/AntlrBuildTask.csproj
+++ b/AntlrBuildTask/AntlrBuildTask.csproj
@@ -23,6 +23,7 @@
<DefineConstants>DEBUG;TRACE</DefineConstants>
<ErrorReport>prompt</ErrorReport>
<WarningLevel>4</WarningLevel>
+    <DocumentationFile>..\bin\Debug\AntlrBuildTask.xml</DocumentationFile>
</PropertyGroup>
<PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
<DebugType>pdbonly</DebugType>
@@ -31,6 +32,7 @@
<DefineConstants>TRACE</DefineConstants>
<ErrorReport>prompt</ErrorReport>
<WarningLevel>4</WarningLevel>
+    <DocumentationFile>..\bin\Release\AntlrBuildTask.xml</DocumentationFile>
</PropertyGroup>
<ItemGroup>
<Reference Include="Microsoft.Build.Engine" />
@@ -60,6 +62,9 @@
<Link>Key.snk</Link>
</None>
<None Include="Antlr3.Java.targets" />
+    <None Include="Antlr3.props">
+      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
+    </None>
</ItemGroup>
<Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
<!-- To modify your build process, add your task inside one of the targets below and uncomment it.
diff --git a/AntlrBuildTask/AntlrClassGenerationTask.cs b/AntlrBuildTask/AntlrClassGenerationTask.cs
index eee9f30..88d1398 100644
--- a/AntlrBuildTask/AntlrClassGenerationTask.cs
+++ b/AntlrBuildTask/AntlrClassGenerationTask.cs
@@ -165,6 +165,12 @@ namespace Antlr3.Build.Tasks
AppDomain domain = null;
bool success;

+            if (!Path.IsPathRooted(AntlrToolPath))
+                AntlrToolPath = Path.Combine(Path.GetDirectoryName(BuildEngine.ProjectFileOfTaskNode), AntlrToolPath);
+
+            if (!Path.IsPathRooted(BuildTaskPath))
+                BuildTaskPath = Path.Combine(Path.GetDirectoryName(BuildEngine.ProjectFileOfTaskNode), BuildTaskPath);
+
try
{
domain = GetAntlrTaskAppDomain();
diff --git a/Reference/antlr3 b/Reference/antlr3
index 16284da..c034866 160000
--- a/Reference/antlr3
+++ b/Reference/antlr3
@@ -1 +1 @@
-Subproject commit 16284da4436bcb57f339db01e81c4bea94663fff
+Subproject commit c034866d7f26832c497733edcfe9818adb5dd9d3
diff --git a/bin/prep/Antlr3.Runtime.Debug.nuspec b/bin/prep/Antlr3.Runtime.Debug.nuspec
new file mode 100644
index 0000000..40d9764
--- /dev/null
+++ b/bin/prep/Antlr3.Runtime.Debug.nuspec
@@ -0,0 +1,34 @@
+<?xml version="1.0" encoding="utf-8"?>
+<package xmlns="http://schemas.microsoft.com/packaging/2010/07/nuspec.xsd">
+  <metadata>
+    <id>Antlr3.Runtime.Debug</id>
+    <version>0.0.0</version>
+    <authors>Sam Harwell, Terence Parr</authors>
+    <owners>Sam Harwell</owners>
+    <description>The runtime library for parsers generated by the C# target of ANTLR 3. This package supports projects targeting .NET 2.0 or newer, and built using Visual Studio 2008 or newer.</description>
+    <language>en-us</language>
+    <projectUrl>https://github.com/sharwell/antlrcs</projectUrl>
+    <licenseUrl>https://raw.github.com/sharwell/antlrcs/master/bin/prep/LICENSE.txt</licenseUrl>
+    <iconUrl>https://raw.github.com/antlr/website-antlr4/master/images/icons/antlr.png</iconUrl>
+    <copyright>Copyright © Sam Harwell 2013</copyright>
+    <releaseNotes>https://github.com/sharwell/antlrcs/releases/v$version$</releaseNotes>
+    <requireLicenseAcceptance>true</requireLicenseAcceptance>
+    <tags>antlr antlr3 parsing</tags>
+    <title>ANTLR 3 Runtime</title>
+    <summary>The runtime library for parsers generated by the C# target of ANTLR 3.</summary>
+    <dependencies>
+      <dependency id="Antlr3.Runtime" version="$version$" />
+    </dependencies>
+  </metadata>
+  <files>
+    <!-- Runtime Libraries -->
+
+    <file src="Tool\Antlr3.Runtime.Debug.dll" target="lib\net20"/>
+    <file src="Tool\Antlr3.Runtime.Debug.pdb" target="lib\net20"/>
+    <file src="Tool\Antlr3.Runtime.Debug.xml" target="lib\net20"/>
+
+    <!-- Source Code -->
+
+    <file exclude="..\..\Reference\antlr3\runtime\CSharp3\Sources\Antlr3.Runtime.Debug\obj\**\*.cs" src="..\..\Reference\antlr3\runtime\CSharp3\Sources\Antlr3.Runtime.Debug\**\*.cs" target="src"/>
+  </files>
+</package>
diff --git a/bin/prep/Antlr3.Runtime.nuspec b/bin/prep/Antlr3.Runtime.nuspec
new file mode 100644
index 0000000..8a26b16
--- /dev/null
+++ b/bin/prep/Antlr3.Runtime.nuspec
@@ -0,0 +1,31 @@
+<?xml version="1.0" encoding="utf-8"?>
+<package xmlns="http://schemas.microsoft.com/packaging/2010/07/nuspec.xsd">
+  <metadata>
+    <id>Antlr3.Runtime</id>
+    <version>0.0.0</version>
+    <authors>Sam Harwell, Terence Parr</authors>
+    <owners>Sam Harwell</owners>
+    <description>The runtime library for parsers generated by the C# target of ANTLR 3. This package supports projects targeting .NET 2.0 or newer, and built using Visual Studio 2008 or newer.</description>
+    <language>en-us</language>
+    <projectUrl>https://github.com/sharwell/antlrcs</projectUrl>
+    <licenseUrl>https://raw.github.com/sharwell/antlrcs/master/bin/prep/LICENSE.txt</licenseUrl>
+    <iconUrl>https://raw.github.com/antlr/website-antlr4/master/images/icons/antlr.png</iconUrl>
+    <copyright>Copyright © Sam Harwell 2013</copyright>
+    <releaseNotes>https://github.com/sharwell/antlrcs/releases/v$version$</releaseNotes>
+    <requireLicenseAcceptance>true</requireLicenseAcceptance>
+    <tags>antlr antlr3 parsing</tags>
+    <title>ANTLR 3 Runtime</title>
+    <summary>The runtime library for parsers generated by the C# target of ANTLR 3.</summary>
+  </metadata>
+  <files>
+    <!-- Runtime Libraries -->
+
+    <file src="Runtime\Antlr3.Runtime.dll" target="lib\net20"/>
+    <file src="Runtime\Antlr3.Runtime.pdb" target="lib\net20"/>
+    <file src="Runtime\Antlr3.Runtime.xml" target="lib\net20"/>
+
+    <!-- Source Code -->
+
+    <file exclude="..\..\Reference\antlr3\runtime\CSharp3\Sources\Antlr3.Runtime\obj\**\*.cs" src="..\..\Reference\antlr3\runtime\CSharp3\Sources\Antlr3.Runtime\**\*.cs" target="src"/>
+  </files>
+</package>
diff --git a/bin/prep/Antlr3.nuspec b/bin/prep/Antlr3.nuspec
new file mode 100644
index 0000000..195d813
--- /dev/null
+++ b/bin/prep/Antlr3.nuspec
@@ -0,0 +1,36 @@
+<?xml version="1.0" encoding="utf-8"?>
+<package xmlns="http://schemas.microsoft.com/packaging/2010/07/nuspec.xsd">
+  <metadata minClientVersion="2.5">
+    <id>Antlr3</id>
+    <version>0.0.0</version>
+    <authors>Sam Harwell, Terence Parr</authors>
+    <owners>Sam Harwell</owners>
+    <description>The C# target of the ANTLR 3 parser generator. This package supports projects targeting .NET 2.0 or newer, and built using Visual Studio 2008 or newer.</description>
+    <language>en-us</language>
+    <projectUrl>https://github.com/sharwell/antlr4cs</projectUrl>
+    <licenseUrl>https://raw.github.com/sharwell/antlr4cs/master/LICENSE.txt</licenseUrl>
+    <iconUrl>https://raw.github.com/antlr/website-antlr4/master/images/icons/antlr.png</iconUrl>
+    <copyright>Copyright © Sam Harwell 2013</copyright>
+    <releaseNotes>https://github.com/sharwell/antlr4cs/releases/v$version$</releaseNotes>
+    <requireLicenseAcceptance>true</requireLicenseAcceptance>
+    <tags>antlr antlr3 parsing</tags>
+    <title>ANTLR 3</title>
+    <summary>The C# target of the ANTLR 3 parser generator.</summary>
+    <dependencies>
+      <dependency id="Antlr3.Runtime" version="$version$" />
+      <dependency id="Antlr3.Runtime.Debug" version="$version$" />
+      <dependency id="StringTemplate3" version="$version$" />
+    </dependencies>
+  </metadata>
+  <files>
+    <!-- Tools -->
+
+    <file src="Bootstrap\**\*.*" target="tools"/>
+
+    <!-- Build Configuration -->
+
+    <file src="Tool\Antlr3.props" target="build"/>
+    <file src="Tool\Antlr3.targets" target="build"/>
+    <file src="Tool\AntlrBuildTask.dll" target="build"/>
+  </files>
+</package>
diff --git a/bin/prep/NuGet.exe b/bin/prep/NuGet.exe
new file mode 100644
index 0000000..be85ec2
Binary files /dev/null and b/bin/prep/NuGet.exe differ
diff --git a/bin/prep/StringTemplate3.nuspec b/bin/prep/StringTemplate3.nuspec
new file mode 100644
index 0000000..488c5e3
--- /dev/null
+++ b/bin/prep/StringTemplate3.nuspec
@@ -0,0 +1,36 @@
+<?xml version="1.0" encoding="utf-8"?>
+<package xmlns="http://schemas.microsoft.com/packaging/2010/07/nuspec.xsd">
+  <metadata>
+    <id>StringTemplate3</id>
+    <version>0.0.0</version>
+    <authors>Sam Harwell, Terence Parr</authors>
+    <owners>Sam Harwell</owners>
+    <description>The C# port of StringTemplate 3.</description>
+    <language>en-us</language>
+    <projectUrl>https://github.com/sharwell/antlrcs</projectUrl>
+    <licenseUrl>https://raw.github.com/sharwell/antlrcs/master/bin/prep/LICENSE.txt</licenseUrl>
+    <iconUrl>https://raw.github.com/antlr/website-antlr4/master/images/icons/antlr.png</iconUrl>
+    <copyright>Copyright © Sam Harwell 2013</copyright>
+    <releaseNotes>https://github.com/sharwell/antlrcs/releases/v$ANTLRVersion$</releaseNotes>
+    <requireLicenseAcceptance>true</requireLicenseAcceptance>
+    <tags>stringtemplate st3 stringtemplate3 template</tags>
+    <title>StringTemplate 3</title>
+    <summary>The C# port of StringTemplate 3.</summary>
+    <dependencies>
+      <dependency id="Antlr3.Runtime" version="$ANTLRVersion$" />
+    </dependencies>
+  </metadata>
+  <files>
+    <!-- Runtime Libraries -->
+
+    <file src="ST3\Antlr3.StringTemplate.dll" target="lib\net35-client"/>
+    <file src="ST3\Antlr3.StringTemplate.pdb" target="lib\net35-client"/>
+    <file src="ST3\Antlr3.StringTemplate.xml" target="lib\net35-client"/>
+
+    <!-- Source Code -->
+
+    <file exclude="..\..\Antlr3.StringTemplate\obj\**\*.cs" src="..\..\Antlr3.StringTemplate\**\*.cs" target="src"/>
+    <file src="..\..\Antlr3.StringTemplate\obj\$Configuration$\**\*.cs" target="src\obj\$Configuration$"/>
+    <file src="..\..\Antlr3.StringTemplate\obj\$Configuration$\**\*.tokens" target="src\obj\$Configuration$"/>
+  </files>
+</package>
diff --git a/bin/prep/StringTemplate4.Visualizer.nuspec b/bin/prep/StringTemplate4.Visualizer.nuspec
new file mode 100644
index 0000000..68984d6
--- /dev/null
+++ b/bin/prep/StringTemplate4.Visualizer.nuspec
@@ -0,0 +1,38 @@
+<?xml version="1.0" encoding="utf-8"?>
+<package xmlns="http://schemas.microsoft.com/packaging/2010/07/nuspec.xsd">
+  <metadata>
+    <id>StringTemplate4.Visualizer</id>
+    <version>0.0.0</version>
+    <authors>Sam Harwell, Terence Parr</authors>
+    <owners>Sam Harwell</owners>
+    <description>Provides the visualizer runtime for StringTemplate 4.</description>
+    <language>en-us</language>
+    <projectUrl>https://github.com/sharwell/antlrcs</projectUrl>
+    <licenseUrl>https://raw.github.com/sharwell/antlrcs/master/bin/prep/LICENSE.txt</licenseUrl>
+    <iconUrl>https://raw.github.com/antlr/website-antlr4/master/images/icons/antlr.png</iconUrl>
+    <copyright>Copyright © Sam Harwell 2013</copyright>
+    <releaseNotes>https://github.com/sharwell/antlrcs/releases/v$ANTLRVersion$</releaseNotes>
+    <requireLicenseAcceptance>true</requireLicenseAcceptance>
+    <tags>stringtemplate st4 stringtemplate4 stviz template</tags>
+    <title>StringTemplate 4 Visualizer</title>
+    <summary>Provides the visualizer runtime for StringTemplate 4.</summary>
+    <dependencies>
+      <dependency id="Antlr3.Runtime" version="$ANTLRVersion$" />
+      <dependency id="StringTemplate4" version="$version$" />
+    </dependencies>
+  </metadata>
+  <files>
+    <!-- Runtime Libraries -->
+
+    <file src="ST4\Antlr4.StringTemplate.Visualizer.dll" target="lib\net35-client"/>
+    <file src="ST4\Antlr4.StringTemplate.Visualizer.pdb" target="lib\net35-client"/>
+    <file src="ST4\Antlr4.StringTemplate.Visualizer.xml" target="lib\net35-client"/>
+
+    <!-- Source Code -->
+
+    <file exclude="..\..\Antlr4.StringTemplate.Visualizer\obj\**\*.cs" src="..\..\Antlr4.StringTemplate.Visualizer\**\*.cs" target="src"/>
+    <file src="..\..\Antlr4.StringTemplate.Visualizer\**\*.xaml" target="src"/>
+    <file src="..\..\Antlr4.StringTemplate.Visualizer\obj\$Configuration$\**\*.cs" target="src\obj\$Configuration$"/>
+    <file src="..\..\Antlr4.StringTemplate.Visualizer\obj\$Configuration$\**\*.tokens" target="src\obj\$Configuration$"/>
+  </files>
+</package>
diff --git a/bin/prep/StringTemplate4.nuspec b/bin/prep/StringTemplate4.nuspec
new file mode 100644
index 0000000..b2924b4
--- /dev/null
+++ b/bin/prep/StringTemplate4.nuspec
@@ -0,0 +1,36 @@
+<?xml version="1.0" encoding="utf-8"?>
+<package xmlns="http://schemas.microsoft.com/packaging/2010/07/nuspec.xsd">
+  <metadata>
+    <id>StringTemplate4</id>
+    <version>0.0.0</version>
+    <authors>Sam Harwell, Terence Parr</authors>
+    <owners>Sam Harwell</owners>
+    <description>The C# port of StringTemplate 4.</description>
+    <language>en-us</language>
+    <projectUrl>https://github.com/sharwell/antlrcs</projectUrl>
+    <licenseUrl>https://raw.github.com/sharwell/antlrcs/master/bin/prep/LICENSE.txt</licenseUrl>
+    <iconUrl>https://raw.github.com/antlr/website-antlr4/master/images/icons/antlr.png</iconUrl>
+    <copyright>Copyright © Sam Harwell 2013</copyright>
+    <releaseNotes>https://github.com/sharwell/antlrcs/releases/v$ANTLRVersion$</releaseNotes>
+    <requireLicenseAcceptance>true</requireLicenseAcceptance>
+    <tags>stringtemplate st4 stringtemplate4 template</tags>
+    <title>StringTemplate 4</title>
+    <summary>The C# port of StringTemplate 4.</summary>
+    <dependencies>
+      <dependency id="Antlr3.Runtime" version="$ANTLRVersion$" />
+    </dependencies>
+  </metadata>
+  <files>
+    <!-- Runtime Libraries -->
+
+    <file src="ST4\Antlr4.StringTemplate.dll" target="lib\net35-client"/>
+    <file src="ST4\Antlr4.StringTemplate.pdb" target="lib\net35-client"/>
+    <file src="ST4\Antlr4.StringTemplate.xml" target="lib\net35-client"/>
+
+    <!-- Source Code -->
+
+    <file exclude="..\..\Antlr4.StringTemplate\obj\**\*.cs" src="..\..\Antlr4.StringTemplate\**\*.cs" target="src"/>
+    <file src="..\..\Antlr4.StringTemplate\obj\$Configuration$\**\*.cs" target="src\obj\$Configuration$"/>
+    <file src="..\..\Antlr4.StringTemplate\obj\$Configuration$\**\*.tokens" target="src\obj\$Configuration$"/>
+  </files>
+</package>
diff --git a/bin/prep/prepare.ps1 b/bin/prep/prepare.ps1
index fe47185..4f06fa2 100644
--- a/bin/prep/prepare.ps1
+++ b/bin/prep/prepare.ps1
@@ -35,7 +35,7 @@ $ArchivePath = ".\Backup\Bootstrap-" + [System.IO.Path]::GetFileNameWithoutExten
.\7z.exe a -r $ArchivePath "..\Bootstrap\*"

# copy the new bootstrap files
-$BootstrapBinaries = "Antlr3.exe", "Antlr3.exe.config", "Antlr3.Runtime.dll", "Antlr3.Runtime.Debug.dll", "Antlr4.StringTemplate.dll", "Antlr4.StringTemplate.Visualizer.dll", "Antlr3.targets", "AntlrBuildTask.dll"
+$BootstrapBinaries = "Antlr3.exe", "Antlr3.exe.config", "Antlr3.Runtime.dll", "Antlr3.Runtime.Debug.dll", "Antlr4.StringTemplate.dll", "Antlr4.StringTemplate.Visualizer.dll", "Antlr3.targets", "Antlr3.props", "AntlrBuildTask.dll"
$BootstrapBinaries | ForEach-Object {
copy -force "..\$BuildConfig\$_" "..\Bootstrap"
if ($LASTEXITCODE -ne 0) {
@@ -106,6 +106,7 @@ mkdir ST3
mkdir ST4
copy "..\$BuildConfig\Antlr3.Runtime.dll" ".\Runtime"
copy "..\$BuildConfig\Antlr3.Runtime.pdb" ".\Runtime"
+copy "..\$BuildConfig\Antlr3.Runtime.xml" ".\Runtime"
copy "LICENSE.txt" ".\Runtime"

copy "..\$BuildConfig\Antlr3.exe" ".\Tool"
@@ -114,6 +115,7 @@ copy "..\$BuildConfig\Antlr3.Runtime.dll" ".\Tool"
copy "..\$BuildConfig\Antlr3.Runtime.Debug.dll" ".\Tool"
copy "..\$BuildConfig\Antlr4.StringTemplate.dll" ".\Tool"
copy "..\$BuildConfig\Antlr4.StringTemplate.Visualizer.dll" ".\Tool"
+copy "..\$BuildConfig\Antlr3.props" ".\Tool"
copy "..\$BuildConfig\Antlr3.targets" ".\Tool"
copy "..\$BuildConfig\AntlrBuildTask.dll" ".\Tool"
copy "LICENSE.txt" ".\Tool"
@@ -127,6 +129,12 @@ copy "..\$BuildConfig\Antlr3.Runtime.Debug.pdb" ".\Tool"
copy "..\$BuildConfig\Antlr4.StringTemplate.pdb" ".\Tool"
copy "..\$BuildConfig\Antlr4.StringTemplate.Visualizer.pdb" ".\Tool"
copy "..\$BuildConfig\AntlrBuildTask.pdb" ".\Tool"
+copy "..\$BuildConfig\Antlr3.xml" ".\Tool"
+copy "..\$BuildConfig\Antlr3.Runtime.xml" ".\Tool"
+copy "..\$BuildConfig\Antlr3.Runtime.Debug.xml" ".\Tool"
+copy "..\$BuildConfig\Antlr4.StringTemplate.xml" ".\Tool"
+copy "..\$BuildConfig\Antlr4.StringTemplate.Visualizer.xml" ".\Tool"
+copy "..\$BuildConfig\AntlrBuildTask.xml" ".\Tool"

mkdir "Tool\Codegen"
mkdir "Tool\Targets"
@@ -134,6 +142,7 @@ mkdir "Tool\Tool"
copy -r "..\$BuildConfig\Codegen\*" ".\Tool\Codegen"
copy -r "..\$BuildConfig\Targets\*.dll" ".\Tool\Targets"
copy -r "..\$BuildConfig\Targets\*.pdb" ".\Tool\Targets"
+copy -r "..\$BuildConfig\Targets\*.xml" ".\Tool\Targets"
copy -r "..\$BuildConfig\Tool\*" ".\Tool\Tool"

mkdir "Bootstrap\Codegen\Templates\CSharp2"
@@ -153,6 +162,8 @@ copy "..\..\Antlr3.StringTemplate\bin\$BuildConfig\Antlr3.StringTemplate.dll" ".
copy "..\..\Antlr3.StringTemplate\bin\$BuildConfig\Antlr3.Runtime.dll" ".\ST3"
copy "..\..\Antlr3.StringTemplate\bin\$BuildConfig\Antlr3.StringTemplate.pdb" ".\ST3"
copy "..\..\Antlr3.StringTemplate\bin\$BuildConfig\Antlr3.Runtime.pdb" ".\ST3"
+copy "..\..\Antlr3.StringTemplate\bin\$BuildConfig\Antlr3.StringTemplate.xml" ".\ST3"
+copy "..\..\Antlr3.StringTemplate\bin\$BuildConfig\Antlr3.Runtime.xml" ".\ST3"
copy "LICENSE.txt" ".\ST3"

# ST4 dist
@@ -162,11 +173,14 @@ copy "..\$BuildConfig\Antlr4.StringTemplate.Visualizer.dll" ".\ST4"
copy "..\$BuildConfig\Antlr3.Runtime.pdb" ".\ST4"
copy "..\$BuildConfig\Antlr4.StringTemplate.pdb" ".\ST4"
copy "..\$BuildConfig\Antlr4.StringTemplate.Visualizer.pdb" ".\ST4"
+copy "..\$BuildConfig\Antlr3.Runtime.xml" ".\ST4"
+copy "..\$BuildConfig\Antlr4.StringTemplate.xml" ".\ST4"
+copy "..\$BuildConfig\Antlr4.StringTemplate.Visualizer.xml" ".\ST4"
copy "LICENSE.txt" ".\ST4"

# compress the distributable packages
-$AntlrVersion = "special-3.5.0.2"
-$STVersion = "special-4.0.7.1"
+$AntlrVersion = "3.5.0.3-alpha001"
+$STVersion = "4.0.7.2-alpha001"

$ArchivePath = ".\dist\antlr-dotnet-csharpbootstrap-" + $AntlrVersion + ".7z"
.\7z.exe a -r -mx9 $ArchivePath ".\Bootstrap\*"
@@ -178,3 +192,16 @@ $ArchivePath = ".\dist\antlr-dotnet-st3-" + $AntlrVersion + ".7z"
.\7z.exe a -r -mx9 $ArchivePath ".\ST3\*"
$ArchivePath = ".\dist\antlr-dotnet-st4-" + $STVersion + ".7z"
.\7z.exe a -r -mx9 $ArchivePath ".\ST4\*"
+
+# Build the NuGet packages
+
+if (-not (Test-Path nuget)) {
+  mkdir "nuget"
+}
+
+.\NuGet.exe pack .\Antlr3.Runtime.nuspec -OutputDirectory nuget -Prop Configuration=Release -Version $AntlrVersion -Prop ANTLRVersion=$AntlrVersion -Prop STVersion=$STVersion -Symbols
+.\NuGet.exe pack .\Antlr3.Runtime.Debug.nuspec -OutputDirectory nuget -Prop Configuration=Release -Version $AntlrVersion -Prop ANTLRVersion=$AntlrVersion -Prop STVersion=$STVersion -Symbols
+.\NuGet.exe pack .\Antlr3.nuspec -OutputDirectory nuget -Prop Configuration=Release -Version $AntlrVersion -Prop ANTLRVersion=$AntlrVersion -Prop STVersion=$STVersion -Symbols
+.\NuGet.exe pack .\StringTemplate3.nuspec -OutputDirectory nuget -Prop Configuration=Release -Version $AntlrVersion -Prop ANTLRVersion=$AntlrVersion -Prop STVersion=$STVersion -Symbols
+.\NuGet.exe pack .\StringTemplate4.nuspec -OutputDirectory nuget -Prop Configuration=Release -Version $STVersion -Prop ANTLRVersion=$AntlrVersion -Prop STVersion=$STVersion -Symbols
+.\NuGet.exe pack .\StringTemplate4.Visualizer.nuspec -OutputDirectory nuget -Prop Configuration=Release -Version $STVersion -Prop ANTLRVersion=$AntlrVersion -Prop STVersion=$STVersion -Symbols

