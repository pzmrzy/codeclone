commit 48e3f2f406b7962277a6ac9d28ff5850de5f5909
Author:     sharwell <sharwell@pixelminegames.com>
AuthorDate: Mon May 2 14:24:06 2011 -0800
Commit:     sharwell <sharwell@pixelminegames.com>
CommitDate: Mon May 2 14:24:06 2011 -0800

(C# 3) CompiledTemplate.ImplicitlyDefinedTemplates returns a non-null ReadOnlyCollection<CompiledTemplate>

[git-p4: depot-paths = "//depot/code/antlrcs/main/": change = 8370]

diff --git a/Antlr4.StringTemplate/Compiler/CompiledTemplate.cs b/Antlr4.StringTemplate/Compiler/CompiledTemplate.cs
index e79b480..a6170fe 100644
--- a/Antlr4.StringTemplate/Compiler/CompiledTemplate.cs
+++ b/Antlr4.StringTemplate/Compiler/CompiledTemplate.cs
@@ -33,10 +33,12 @@
namespace Antlr4.StringTemplate.Compiler
{
using System.Collections.Generic;
+    using System.Collections.ObjectModel;
using System.Linq;
using Antlr.Runtime;
using Antlr.Runtime.Tree;
using Antlr4.StringTemplate.Misc;
+
using ArgumentNullException = System.ArgumentNullException;
using Console = System.Console;
using StringWriter = System.IO.StringWriter;
@@ -48,6 +50,9 @@ namespace Antlr4.StringTemplate.Compiler
*/
public class CompiledTemplate
{
+        private static readonly ReadOnlyCollection<CompiledTemplate> EmptyImplicitlyDefinedTemplates =
+            new ReadOnlyCollection<CompiledTemplate>(new CompiledTemplate[0]);
+
private string _name;

/** The original, immutable pattern (not really used again after
@@ -201,16 +206,14 @@ namespace Antlr4.StringTemplate.Compiler
}
}

-        public List<CompiledTemplate> ImplicitlyDefinedTemplates
+        public ReadOnlyCollection<CompiledTemplate> ImplicitlyDefinedTemplates
{
get
{
-                return implicitlyDefinedTemplates;
-            }
+                if (implicitlyDefinedTemplates == null)
+                    return EmptyImplicitlyDefinedTemplates;

-            set
-            {
-                implicitlyDefinedTemplates = value;
+                return implicitlyDefinedTemplates.AsReadOnly();
}
}

@@ -320,10 +323,10 @@ namespace Antlr4.StringTemplate.Compiler

public virtual void AddImplicitlyDefinedTemplate(CompiledTemplate sub)
{
-            if (ImplicitlyDefinedTemplates == null)
-                ImplicitlyDefinedTemplates = new List<CompiledTemplate>();
+            if (implicitlyDefinedTemplates == null)
+                implicitlyDefinedTemplates = new List<CompiledTemplate>();

-            ImplicitlyDefinedTemplates.Add(sub);
+            implicitlyDefinedTemplates.Add(sub);
}

public virtual void DefineArgumentDefaultValueTemplates(TemplateGroup group)

