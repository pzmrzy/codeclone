commit b8dca9df37d9ae727c9982c62ca14098ae54423d
Author:     sharwell <sharwell@pixelminegames.com>
AuthorDate: Sun May 15 13:12:47 2011 -0800
Commit:     sharwell <sharwell@pixelminegames.com>
CommitDate: Sun May 15 13:12:47 2011 -0800

(C# 3) Add ListStack<T> to allow indexing on the attribute scope stacks

[git-p4: depot-paths = "//depot/code/antlr/antlr3-main/": change = 8500]

diff --git a/Antlr3.Runtime/Antlr3.Runtime.csproj b/Antlr3.Runtime/Antlr3.Runtime.csproj
index a311d92..6de4bf7 100644
--- a/Antlr3.Runtime/Antlr3.Runtime.csproj
+++ b/Antlr3.Runtime/Antlr3.Runtime.csproj
@@ -76,6 +76,7 @@
<Compile Include="Lexer.cs" />
<Compile Include="Misc\FastQueue.cs" />
<Compile Include="Misc\FunctionDelegates.cs" />
+    <Compile Include="Misc\ListStack`1.cs" />
<Compile Include="Misc\LookaheadStream.cs" />
<Compile Include="MismatchedNotSetException.cs" />
<Compile Include="MismatchedRangeException.cs" />
diff --git a/Antlr3.Runtime/Misc/ListStack`1.cs b/Antlr3.Runtime/Misc/ListStack`1.cs
new file mode 100644
index 0000000..e66adcb
--- /dev/null
+++ b/Antlr3.Runtime/Misc/ListStack`1.cs
@@ -0,0 +1,98 @@
+ï»¿/*
+ * [The "BSD license"]
+ * Copyright (c) 2011 Terence Parr
+ * All rights reserved.
+ *
+ * Conversion to C#:
+ * Copyright (c) 2011 Sam Harwell, Pixel Mine, Inc.
+ * All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. The name of the author may not be used to endorse or promote products
+ *    derived from this software without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
+ * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
+ * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
+ * IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
+ * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
+ * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
+ * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
+ * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
+ * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
+ * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+ */
+
+namespace Antlr.Runtime.Misc
+{
+    using System.Collections.Generic;
+    using InvalidOperationException = System.InvalidOperationException;
+
+    public class ListStack<T> : List<T>
+    {
+        public T Peek()
+        {
+            return Peek(0);
+        }
+
+        public T Peek(int depth)
+        {
+            T item;
+            if (!TryPeek(depth, out item))
+                throw new InvalidOperationException();
+
+            return item;
+        }
+
+        public bool TryPeek(out T item)
+        {
+            return TryPeek(0, out item);
+        }
+
+        public bool TryPeek(int depth, out T item)
+        {
+            if (depth >= Count)
+            {
+                item = default(T);
+                return false;
+            }
+
+            item = this[Count - depth - 1];
+            return true;
+        }
+
+        public T Pop()
+        {
+            T result;
+            if (!TryPop(out result))
+                throw new InvalidOperationException();
+
+            return result;
+        }
+
+        public bool TryPop(out T item)
+        {
+            if (Count == 0)
+            {
+                item = default(T);
+                return false;
+            }
+
+            item = this[Count - 1];
+            RemoveAt(Count - 1);
+            return true;
+        }
+
+        public void Push(T item)
+        {
+            Add(item);
+        }
+    }
+}

